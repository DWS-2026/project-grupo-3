<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">

    <!-- Para hacer el diseño responsive -->
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Green Care</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

    <!-- CSS externo -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/management.css">
    <script src="https://code.jquery.com/jquery-3.6.4.min.js" integrity="sha256-oP6HI9z1XaZNBrJURtCoUT5SUnxFr8s3BzRl+cbzUq8=" crossorigin="anonymous"></script>

</head>
<body>
{{>header}}
<main class="header-main d-flex align-items-center flex-column">

    <h1>Gestión de Productos</h1>
    <p class="lead">Administra los productos de la tienda: añade, revisa o elimina.</p>

    <!-- TABLA DE PRODUCTOS -->
    <table class="table table-bordered text-center">
        <thead class="table-success">
        <tr>
            <th>Seleccionar</th>
            <th>Nombre</th>
            <th>Precio</th>
            <th>Imagen</th>
        </tr>
        </thead>
        <tbody id="product-table">
            <tr>
                <td><input type="checkbox"></td>
                <td>Fertilizante</td>
                <td>€12.99</td>
                <td><img src="/assets/images/productos/fertilizante.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Tierra Compostada</td>
                <td>€9.99</td>
                <td><img src="/assets/images/productos/tierracompostada.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Maceta</td>
                <td>€5.99</td>
                <td><img src="/assets/images/productos/maceta.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Insecticida Natural</td>
                <td>€11.99</td>
                <td><img src="/assets/images/productos/insecticidanatural.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Semillas</td>
                <td>€1.99</td>
                <td><img src="/assets/images/productos/semillas.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Guantes</td>
                <td>€4.99</td>
                <td><img src="/assets/images/productos/guantes.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Regadera</td>
                <td>€8.99</td>
                <td><img src="/assets/images/productos/regadera.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Abono</td>
                <td>€13.99</td>
                <td><img src="/assets/images/productos/abono.jpg" width="50"></td>
            </tr>

            <tr>
                <td><input type="checkbox"></td>
                <td>Sustrato Universal</td>
                <td>€7.99</td>
                <td><img src="/assets/images/productos/sustratouniversal.jpg" width="50"></td>
            </tr>
        </tbody>

    </table>
    <div class="mb-3">
        <a href="/Productos/nuevoProducto" class="text-decoration-none">
            <button class="btn main-button" id="add-selected">Añadir producto</button>
        </a>
        <button class="btn main-button" id="edit-selected">Editar seleccionado</button>
        <button class="btn btn-danger" id="delete-selected">Eliminar seleccionado</button>
    </div>
</main>

<script>
    document.getElementById("edit-selected").addEventListener("click", () => {
        const filas = document.querySelectorAll("#product-table tr");
        let seleccionado = null;

        filas.forEach(fila => {
            const checkbox = fila.querySelector("input[type='checkbox']");
            if (checkbox && checkbox.checked) {
                if (seleccionado) {
                    alert("Solo puedes editar un producto a la vez");
                    seleccionado = null;
                    return;
                }
                seleccionado = fila;
            }
        });

        if (!seleccionado) {
            alert("Selecciona un producto para editar");
            return;
        }

        const producto = {
            nombre: seleccionado.children[1].innerText,
            precio: seleccionado.children[2].innerText.replace("€", ""),
            imagen: seleccionado.children[3].querySelector("img").src
        };

        sessionStorage.setItem("productoEditar", JSON.stringify(producto));
        window.location.href = "/Productos/editProduct";
    });
</script>
{{>footer}}
</body>
</html>
